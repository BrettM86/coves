# Coves Local Development Environment Configuration
# This file contains all environment variables for the local atProto development stack
# DO NOT commit secrets to version control in production!

# =============================================================================
# PostgreSQL Configuration (Development Database)
# =============================================================================
# Development database for Coves AppView (runs on port 5433)
POSTGRES_HOST=localhost
POSTGRES_PORT=5433
POSTGRES_DB=coves_dev
POSTGRES_USER=dev_user
POSTGRES_PASSWORD=dev_password

# =============================================================================
# PDS (Personal Data Server) Configuration
# =============================================================================
# PDS runs on port 3001 (to avoid conflict with production PDS on :3000)
PDS_HOSTNAME=localhost
PDS_PORT=3001

# DID PLC Directory (use Bluesky's for development)
PDS_DID_PLC_URL=https://plc.directory

# JWT Secret (for signing tokens - change in production!)
PDS_JWT_SECRET=local-dev-jwt-secret-change-in-production

# Admin password for PDS management
PDS_ADMIN_PASSWORD=admin

# Handle domains (users will get handles like alice.local.coves.dev)
PDS_SERVICE_HANDLE_DOMAINS=.local.coves.dev

# PLC Rotation Key (k256 private key in hex format - for local dev only)
# This is a randomly generated key for testing - DO NOT use in production
PDS_PLC_ROTATION_KEY=af514fb84c4356241deed29feb392d1ee359f99c05a7b8f7bff2e5f2614f64b2

# =============================================================================
# AppView Configuration (Your Go Application)
# =============================================================================
# AppView runs on port 8081 (to avoid conflicts)
APPVIEW_PORT=8081

# PDS Firehose URL (WebSocket connection - direct to PDS, no relay)
FIREHOSE_URL=ws://localhost:3001/xrpc/com.atproto.sync.subscribeRepos

# PDS URL (for XRPC calls)
PDS_URL=http://localhost:3001

# =============================================================================
# Test Database Configuration
# =============================================================================
# Test database runs on port 5434 (separate from dev on 5433)
POSTGRES_TEST_DB=coves_test
POSTGRES_TEST_USER=test_user
POSTGRES_TEST_PASSWORD=test_password
POSTGRES_TEST_PORT=5434

# =============================================================================
# Development Settings
# =============================================================================
# Environment
ENV=development
NODE_ENV=development

# Logging
LOG_LEVEL=debug
LOG_ENABLED=true

# =============================================================================
# Notes
# =============================================================================
# All local development configuration in one file!
# - Dev PostgreSQL:  port 5433
# - Test PostgreSQL: port 5434 (via --profile test)
# - PDS:             port 3001 (avoids conflict with production on :3000)
# - AppView:         port 8081
# - PDS is self-contained (SQLite + CAR files)
# - PostgreSQL is only for Coves AppView indexing
# - AppView subscribes directly to PDS firehose (no relay needed)
# - PDS firehose: ws://localhost:3001/xrpc/com.atproto.sync.subscribeRepos
