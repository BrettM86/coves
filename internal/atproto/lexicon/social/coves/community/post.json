{
  "lexicon": 1,
  "id": "social.coves.community.post",
  "defs": {
    "main": {
      "type": "record",
      "description": "A post in a Coves community. Posts live in community repositories and persist independently of the author.",
      "key": "tid",
      "record": {
        "type": "object",
        "required": ["community", "author", "createdAt"],
        "properties": {
          "community": {
            "type": "string",
            "format": "at-identifier",
            "description": "DID or handle of the community this was posted to"
          },
          "author": {
            "type": "string",
            "format": "did",
            "description": "DID of the user who created this post"
          },
          "title": {
            "type": "string",
            "maxGraphemes": 300,
            "maxLength": 3000,
            "description": "Post title (optional for media-only posts)"
          },
          "content": {
            "type": "string",
            "maxGraphemes": 10000,
            "maxLength": 100000,
            "description": "Post content - supports rich text via facets"
          },
          "facets": {
            "type": "array",
            "description": "Annotations for rich text (mentions, links, tags)",
            "items": {
              "type": "ref",
              "ref": "social.coves.richtext.facet"
            }
          },
          "embed": {
            "type": "union",
            "description": "Embedded media, external links, or quoted posts",
            "refs": [
              "social.coves.embed.images",
              "social.coves.embed.video",
              "social.coves.embed.external",
              "social.coves.embed.post"
            ]
          },
          "langs": {
            "type": "array",
            "description": "Languages used in the post content (ISO 639-1)",
            "maxLength": 3,
            "items": {
              "type": "string",
              "format": "language"
            }
          },
          "labels": {
            "type": "ref",
            "ref": "com.atproto.label.defs#selfLabels",
            "description": "Self-applied content labels (NSFW, spoilers, etc.)"
          },
          "tags": {
            "type": "array",
            "description": "User-applied topic tags",
            "maxLength": 8,
            "items": {
              "type": "string",
              "maxLength": 64,
              "maxGraphemes": 64
            }
          },
          "crosspostOf": {
            "type": "ref",
            "ref": "com.atproto.repo.strongRef",
            "description": "If this is a crosspost, strong reference to the immediate parent post"
          },
          "crosspostChain": {
            "type": "array",
            "description": "Full chain of crossposts with version pinning. First element is original, last is immediate parent.",
            "maxLength": 25,
            "items": {
              "type": "ref",
              "ref": "com.atproto.repo.strongRef"
            }
          },
          "createdAt": {
            "type": "string",
            "format": "datetime",
            "description": "Timestamp of post creation"
          }
        }
      }
    }
  }
}
