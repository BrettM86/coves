{
  "lexicon": 1,
  "id": "social.coves.aggregator.authorization",
  "defs": {
    "main": {
      "type": "record",
      "description": "Authorization for an aggregator to post to a community with specific configuration. Published in the community's repository by moderators. Similar to social.coves.actor.subscription.",
      "key": "any",
      "record": {
        "type": "object",
        "required": ["aggregatorDid", "communityDid", "enabled", "createdAt", "createdBy"],
        "properties": {
          "aggregatorDid": {
            "type": "string",
            "format": "did",
            "description": "DID of the authorized aggregator"
          },
          "communityDid": {
            "type": "string",
            "format": "did",
            "description": "DID of the community granting access (must match repo DID)"
          },
          "enabled": {
            "type": "boolean",
            "description": "Whether this aggregator is currently active. Can be toggled without deleting the record."
          },
          "config": {
            "type": "unknown",
            "description": "Aggregator-specific configuration. Must conform to the aggregator's configSchema."
          },
          "createdAt": {
            "type": "string",
            "format": "datetime"
          },
          "createdBy": {
            "type": "string",
            "format": "did",
            "description": "DID of moderator who authorized this aggregator"
          },
          "disabledAt": {
            "type": "string",
            "format": "datetime",
            "description": "When this authorization was disabled (if enabled=false)"
          },
          "disabledBy": {
            "type": "string",
            "format": "did",
            "description": "DID of moderator who disabled this aggregator"
          }
        }
      }
    }
  }
}
